<!--
 Sistema de Gestion de Laboratorios - ESPE
 
 Author: Jerson Morocho
 Revisado por: Jerson Morocho
 -->


<?php $__env->startSection('content'); ?>
<?php echo $__env->make('shared.title', array('titulo' => 'Reporte Materias por Carrera'), array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>

<div class="container-fluid">
  <div class="row mb-3">
    <div class="col">
      <form action="<?php echo e(url('/reporte/materia/carrera')); ?>" method="post">
        <input type="hidden" name="_token" value="<?php echo e(csrf_token()); ?>">
        <div class="card border-primary mb-3">
          <div class="card-header text-primary">Consultar</div>
          <div class="card-body text-primary">
            <select class="form-control" title="Seleccione un Periodo..." name="PER_CODIGO"
              data-live-search="true" data-width="100%">
              <?php foreach($periodos as $periodo): ?>
              <?php if($periodo->PER_CODIGO==$valores['PER_CODIGO']): ?>
              <option value="<?php echo e($periodo->PER_CODIGO); ?>" selected><?php echo e($periodo->PER_NOMBRE); ?></option>
              <?php else: ?>
              <option value="<?php echo e($periodo->PER_CODIGO); ?>"><?php echo e($periodo->PER_NOMBRE); ?></option>
              <?php endif; ?>
              <?php endforeach; ?>
            </select>
            <br>
            <select class="form-control" title="Seleccione una Carrera..." name="CAR_CODIGO"
              data-live-search="true" data-width="100%">
              <?php foreach($carreras as $carrera): ?>
              <?php if($carrera->CAR_CODIGO == $valores['CAR_CODIGO']): ?>
              <option value="<?php echo e($carrera->CAR_CODIGO); ?>" selected><?php echo e($carrera->CAR_NOMBRE); ?></option>
              <?php else: ?>
              <option value="<?php echo e($carrera->CAR_CODIGO); ?>"><?php echo e($carrera->CAR_NOMBRE); ?></option>
              <?php endif; ?>
              <?php endforeach; ?>
            </select>
            <br>
            <button type="submit" class="btn btn-primary"><span class="oi oi-magnifying-glass"></span>
              Consultar
            </button>
          </div>
        </div>
      </form>
    </div>

    <div class="col">
      <div class="card border-info mb-3">
        <div class="card-header text-info">Opciones</div>
        <div class="card-body text-info">
          <h5 class="card-title">Descargar</h5>
          <p>Descargue el reporte a su ordenador en formato PDF.</p>
          <?php if(isset($materias)): ?>
          <a href="<?php echo e(url('reporte/pdfmateriacarrera/'.$periodox->PER_CODIGO.'/'.$carrerax->CAR_CODIGO.'')); ?>" class="btn btn-info"><span class="oi oi-cloud-download"></span> Exportar a  PDF</a>
          <?php else: ?>
          <button disabled class="btn btn-info">
            <span class="oi oi-cloud-download"></span> Exportar a PDF
          </button>
          <?php endif; ?>
        </div>
      </div>
    </div>
  </div>

  <?php if($materias != null ): ?>
  <p id="carrera">
    <span class="h6 mb-2" style="margin-right:150px;">REPORTE: &emsp;
      <span style="font-weight: 300;">MATERIAS POR CARRERAS</span>
    </span>

    <span class="h6" style="margin-right:150px;">PERIODO: &emsp;
      <?php foreach($periodos as $per): ?>
      <?php if($per->PER_CODIGO == $valores['PER_CODIGO']): ?>
      <span style="font-weight: 300;"><?php echo e($per->PER_NOMBRE); ?></span>
      <?php endif; ?>
      <?php endforeach; ?>
    </span>

    <span class="h6" style="margin-right:150px;">CARRERA: &emsp;
      <?php foreach($carreras as $car): ?>
      <?php if($car->CAR_CODIGO == $valores['CAR_CODIGO']): ?>
      <span style="font-weight: 300;"><?php echo e($car->CAR_NOMBRE); ?></span>
      <?php endif; ?>
      <?php endforeach; ?>
    </span>
  </p>
  <table id="materiaCarreraTable" class="table table-hover table-bordered table-sm">
    <thead>
      <tr>
        <th class="text-center">ORD</th>
        <th class="text-center">MATERIA</th>
        <th class="text-center">NRC</th>
        <th class="text-center">DOCENTE</th>
        <th class="text-center">CREDITOS</th>
        <th class="text-center">ESTUDIANTES</th>
        <th class="text-center">ABREVIATURA</th>
      </tr>
    </thead>
    <tbody>
 <input type="hidden" value="<?php echo e($cont=1); ?>">
<?php foreach($materias as $mat ): ?>
      <tr>
        <td class="text-center"><?php echo e($cont++); ?></td>
        <td><?php echo e($mat ->MAT_NOMBRE); ?></td>
        <td class="text-center"><?php echo e($mat ->MAT_NRC); ?></td>
        <td><?php echo e($mat->docente->DOC_NOMBRES.' '.$mat->docente->DOC_APELLIDOS); ?></td>
        <td class="text-center"><?php echo e($mat ->MAT_CREDITOS); ?></td>
        <td class="text-center"><?php echo e($mat ->MAT_NUM_EST); ?></td>
        <td><?php echo e($mat ->MAT_ABREVIATURA); ?></td>
      </tr>
      <?php endforeach; ?>
    </tbody>
  </table>
  <?php endif; ?>
</div>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('app', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>